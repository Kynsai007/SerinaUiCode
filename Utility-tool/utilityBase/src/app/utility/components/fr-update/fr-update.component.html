<div>
    <div class="centerAll" id="cont">
        <ul class="nav nav-cmp" id="myTab" role="tablist">
            <li >
                <a class="f-13" [ngClass]="{ 'active': activeTab === 'Updatefr' }" id="Updatefr-tab" data-toggle="tab" href="#Updatefr" role="tab"
                    aria-controls="Updatefr" aria-selected="true">Update FR Config</a>
            </li>
            <li >
                <a class="f-13" [ngClass]="{ 'disabled': !enableTabsBoolean, 'active': activeTab === 'mob' }" id="mob-tab" data-toggle="tab"
                    href="#mob" role="tab" aria-controls="mob" aria-selected="false">Training Samples</a>
            </li>
            <!-- <li >
                <a class="nav-link f-13" [ngClass]="{ 'disabled': !enableMetaDataBoolean && !htmluploaded, 'active': activeTab === 'meta' }" id="meta-tab" data-toggle="tab"
                    href="#meta" role="tab" aria-controls="meta" aria-selected="false">Meta Data</a>
            </li> -->
            <li >
                <a class="f-13" [ngClass]="{ 'disabled': enableMetaDataBoolean && htmluploaded, 'active': activeTab === 'meta' }" id="meta-tab" data-toggle="tab"
                    href="#meta" role="tab" aria-controls="meta" aria-selected="false">Meta Data</a>
            </li>
            
        </ul>
    
        <div class="tab-content" id="myTabContent">
            <div class="tab-pane fade show active font_weight" id="Updatefr" role="tabpanel" aria-labelledby="Updatefr-tab">
                <div class="head-part">
                    <div>
                        <div class="form-head">Form Recogniser configurations</div>
                        <div class="ven-nam"> {{vendorName}}</div>
                    </div>
                    <div>
                        <button class="btn btn-info f-13 btn-sm  btn-view" style="float: right;margin-left: 10px;" data-toggle="modal"
                        data-target="#AccuracyModal" (click)="openModal('vewCfdScr')">View Confidence Scores<i class="fa fa-eye"></i></button>
                        <button class="btn btn-info f-13 btn-sm btn-view" style="float: right;margin-left: 10px;" data-toggle="modal"
                        data-target="#FieldsModal" (click)="openModal('vewTagInfo')">View Tagged Info <i class="fa fa-eye"></i> </button>
                        <button class="btn btn-default f-13 btn-sm btn-add" data-toggle="modal" style="float: right;margin-left: 10px;"
                        data-target="#myModal" (click)="openModal('addTmpt')"><span>Add Template</span>  <i class="fa fa-plus"></i></button>   
                    </div>
                </div>

                <div *ngIf="frLoadBoolean else spinner">
                    <div class="mt-4" *ngFor="let frData of FRConfigData;">
                        
                        <form class="form" #updateFrConfig = "ngForm" (ngSubmit)="updateFr(updateFrConfig.value)" style="display: flex;">
                            <div style="width: 70%; ">
                                <table class="fr-table" >
                                    <tr class="trHeight trTemp" >
                                        <td class="tdLeft f-13">Template Name</td>
                                        <td class="tdRight">
                                            <select  id="template" class="form-control f-13"
                                                (change)="selectTemplate($event.target.value)">
                                                <option value="selected" [selected]="checkselect" disabled>Select vendor Template</option>
                                                <option [value]="modal.idDocumentModel" *ngFor="let modal of modalList">
                                                    {{modal.modelName}}</option>
                                            </select>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        <!-- display user created and updated -->
                        <div class="r-table"  style="width: 30%; " *ngIf="modelData">
                            <table class="tab-full">
                                <tr >
                                    <td class="tb-lab">Created By</td>
                                    <td class="tb-ip" style="padding: 0;">
                                        <input type="text" name="created_by_username" class="form-control f-13 ip-field" [(ngModel)]="modelData.created_by_username" [value]="modelData.created_by_username" placeholder="Created by" readonly>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="tb-lab">Updated By</td>
                                    <td class="tb-ip" style="padding: 0;">
                                        <input type="text" name="updated_by_username" class="form-control f-13 ip-field" [(ngModel)]="modelData.updated_by_username" [value]="modelData.updated_by_username" placeholder="Update by" readonly>
                                    </td>
                                </tr>
                            </table> 
                        </div>
                        </form>
                    </div>
                </div>
                <div class="page-button">
                    <button class="btncancel f-13" type="button" (click)="onCancel()">Back</button>
                    <button class="btnbg f-13  btn-next" type="button"[ngClass]="!enableTabsBoolean ? 'disabled':''" (click)="goToTrainingSamples()" id="mob-tab" data-toggle="tab"
                    href="#mob" role="tab" aria-controls="mob" aria-selected="false" >Next <i class="fa fa-arrow-right"></i></button>
                </div>
                <ng-template #spinner>
                    <div class="loader"></div>
                </ng-template>
            </div>
            <div class="tab-pane fade font_weight headings" id="mob" role="tabpanel" aria-labelledby="mob-tab">
                <div>
                 <ng-container #outlet >
                    <app-mob [modelData]="modelData" [frConfigData]="FRConfigData" (updateStatus)="statusUpdate($event)" (enableTab)="enableMetaDataTab($event)"></app-mob>
                    <div class="container p-2 butn-cntr">
                        <button class="btn btncancel f-13 ml-3">Cancel</button>
                        <button class="btnbg f-13 btn-next" [disabled]="!enableMetaDataBoolean" data-toggle="tab" href="#meta"
                        role="tab" (click)="changeActiveTab()">Next<i class="fa fa-arrow-right"></i></button>
                    </div>
                 </ng-container>
               </div>
           
               <ng-template #content>
                
               </ng-template>
            </div>
            <div class="tab-pane fade font_weight headings" id="meta" role="tabpanel" aria-labelledby="meta-tab">
                <div class="head-part">
                    <div class="hd-part">
                        <span class="form-head"> Template Meta Data Configurations</span>
                        <span class="ven-nam"> {{vendorName}}</span>
                    </div>
                </div>
                <div class="f-right" style="display: none;">
                    <div class=" mb-3">
                        <div class="permisionDiv">
                          <div> <span class="f-13 mr-3">Batch Process</span>
                            <span class="f-right">
                              <label class="switch">
                                <input type="checkbox" [checked]="batchBoolean" (change)="batchProcessToggle($event.target.checked)"
                                        name="batchmap" ngModel #batchmap="ngModel"
                                />
                                <span class="slider round"></span>
                              </label>
                            </span>
                          </div>
                        </div>
                      </div>
                </div>
                <div class="mt-3">
                    <form #updateMetaData ="ngForm" (ngSubmit)="updateMetainfo(updateMetaData.value)">
                        <table class="tab-deta">
                            <div class="table-full">
                                <tr>
                                    <td class="trHeight" >
                                        <div class="label f-13">Date Format</div>
                                        <div class="tdRight">
                                            <select
                                                name="DateFormat"
                                                id="DateFormat"
                                                class="form-control max_width f-13"
                                                [(ngModel)]="selected_template"
                                                ngModel
                                                #DateFormat="ngModel"
                                            >
                                                <option value="" selected disabled>Select Date format</option>
                                                <option [value]="format" *ngFor="let format of dateFormats">{{ format }}</option>
                                            </select>
                                        </div>
                                    </td>
                            
                                    <td class="trHeight" >
                                        <div class="label f-13">Folder Path</div>
                                        <div class="tdRight">
                                            <input
                                                type="text"
                                                class="form-control max_width f-13"
                                                name="FolderPath"
                                                id="FolderPath"
                                                ngModel
                                                #FolderPath="ngModel"
                                                placeholder="Blob Folder"
                                                readonly
                                            />
                                        </div>
                                    </td>
                            
                                    <td class="trHeight" >
                                        <div class="label f-13">Overall Model</div>
                                        <div class="tdRight">
                                            <input
                                                type="text"
                                                class="form-control max_width1 f-13 mr-2 w-100"
                                                id="AccuracyOverall"
                                                name="AccuracyOverall"
                                                ngModel
                                                #AccuracyOverall="ngModel"
                                                placeholder="Overall Model"
                                            />
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="trHeight" >
                                        <div class="label f-13">Field Wise</div>
                                        <div class="tdRight">
                                            <input
                                                type="text" class="form-control max_width1 f-13" name="AccuracyFeild" 
                                                id="AccuracyFeild" ngModel #AccuracyFeild="ngModel" placeholder="Field Wise"
                                            />
                                        </div>
                                    </td>
                                    <td class="trHeight" >
                                        <div class="label f-13">UnitPrice Tolerance percent</div>
                                        <div class="tdRight">
                                            <input
                                            type="number" min="0" max="100" class="form-control max_width1 f-13 mr-2" 
                                            id="unitprice_tol" name="UnitPriceTol_percent" ngModel #UnitPriceTol_percent="ngModel" 
                                            />
                                        </div>
                                    </td>
                                    <td class="trHeight" >
                                        <div class="label f-13">Quantity Tolerance percent</div>
                                        <div class="tdRight">
                                            <input
                                            type="text" class="form-control max_width1 f-13" name="AccuracyFeild" id="AccuracyFeild" 
                                            ngModel #AccuracyFeild="ngModel" placeholder="Field Wise"
                                            />
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="trHeight" >
                                        <div class="label f-13">Currency</div>
                                        <div class="tdRight">
                                            <select name="Units" id="Units" ngModel #Units="ngModel" class="form-control max_width f-13">
                                            <option *ngFor="let cur of currencies" [value]="cur.currency">{{cur.description}} - {{cur.currency}}</option>
                                    </select>
                                        </div>
                                    </td>
                                    <td class="trHeight" >
                                        <div class="label f-13">Language</div>
                                        <div class="tdRight">
                                            <select name="temp_language" id="temp_language" ngModel #Units="ngModel" class="form-control max_width f-13">
                                            <option *ngFor="let lang of languages" [value]="lang.code">{{lang.language}}</option>
                                        </select>
                                        </div>
                                    </td>
                                    <td class="trHeight" >
                                        <div class="label f-13">Decimal Separator for Totals</div>
                                        <div class="tdRight">
                                            <select name="current_po_format" id="current_po_format" ngModel #Units="ngModel" class="form-control max_width f-13">
                                        <option *ngFor="let dec of decimal_sep" [value]="dec.value">{{dec.display}}</option>
                                    </select>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="trHeight" >
                                        <div class="label f-13">Select Vendor type <span class="req_clr">*</span></div>
                                        <div class="tdRight">
                                            <select name="vendorType" id="vendorType" ngModel #vendorType="ngModel" class="form-control max_width f-13" 
                                                [(ngModel)]="selectedVendorType" (change)="onChangeVndrType(selectedVendorType)" required>
                                                <option value="" selected disabled>Select Vendor type</option>
                                                <option *ngFor="let rule of vendorTypeData" [value]="rule.value">{{rule.value}}</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td class="trHeight" >
                                        <div class="label f-13">Select ERP API Rule<span class="req_clr">*</span></div>
                                        <div class="tdRight">
                                            <select name="erprule" id="erprule" ngModel #erprule="ngModel" class="form-control max_width f-13" 
                                                [(ngModel)]="selectErpRule"required>
                                                <option value="" selected disabled>Select Amount Rule</option>
                                                <option *ngFor="let rule of amountRulesData" [value]="rule.iderprules" 
                                                [ngClass]="rule.IsActive == 0 ? 'opaque' : 'clearopaque'">{{rule.Name}}</option>
                                            </select>
                                        </div>
                                    </td>
                                    <td>
                                        <div class="label f-13">TRN is Mandatory?<span class="req_clr">*</span></div>
                                        <div class="toggle-border">
                                            <input id="one" type="checkbox" [checked]="trnboolean" (change)="trnMandatoryToggle($event.target.checked)"/>
                                            <label for="one">
                                            <div class="handle"></div>
                                            </label>
                                            <span class="tog-span">yes</span>
                                        </div>
                                    </td>
                                </tr>
                            </div>
                            <div class="table-scn">
                                <tr>
                                    <td class="trHeight">
                                        <div class="label f-13">Select Header Mandatory tags</div>
                                        <div class="tdRight" style="position: relative;">
                                            <div class="multipleSelection">
                                                <div class="selectBox w-100">
                                                    <ul class="ulTags max_width" [title]="headerArray.toString()">
                                                        <li class="listData" *ngFor="let tag of sortedHeaderArray(); let i = index;">
                                                            {{tag}}
                                                            <span (click)="removeHeaderTag(i, tag)">
                                                                <i class="fa fa-times-circle-o ml-2" style="cursor: pointer;" aria-hidden="true"></i>
                                                            </span>
                                                        </li>
                                                    </ul>
                                                    <div class="downArrow" (click)="showHeaderCheckboxes()">
                                                        <i class="fa fa-angle-down" aria-hidden="true"></i>
                                                    </div>
                                                </div>
                                    
                                                <div id="checkBoxes" *ngIf="showCheckboxHeaderDiv">
                                                    <label *ngFor="let header of sortedHeaderTags()">
                                                        <input type="checkbox" (change)="selectHeader($event.target.checked, header.Name)" [checked]="header.Ismendatory == 1 || headerArray.includes(header.Name)" />
                                                        {{header.Name}}
                                                        <span *ngIf="header.Ismendatory == 1" style="color: red;">*</span>
                                                    </label>
                                                </div>
                                            </div>
                                        </div>
                                    </td>
                                </tr>
                            </div>
                            
                        </table>
                        <div class=" butn-cntr">
                            <button type="button" class="btn btncancel f-13">Cancel</button>
                            <button type="submit" class="btnbg f-13 btn-next" [disabled]="saving">Proceed to Onboarding 
                                <div *ngIf="saving" class="spinner-border spinner-border-sm" role="status"></div></button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div *ngIf="isModalOpen" class="modal fade" id="myModal">
    <div class="dialog-container">
        <button class="close-button" (click)="closeModal()" id="closeBtn"><span>×</span></button>
        <div class="dialog-header">
            <h2>Add New Template</h2>
        </div>
        <div class="dialog-content">
            <form #createTemplate="ngForm" (ngSubmit)="createModel(createTemplate.value)">
                <div class="form-group">
                    <label>Select Vendor Account <span>*</span></label>
                    <select  name="idVendorAccount" ngModel
                        #idVendorAccount="ngModel" (change)="selectVendorAccont($event.target.value)" required>
                        <option value="" selected disabled>Select vendor account</option>
                        <option *ngFor="let vendor of vendorAccountList" [value]="vendor.idVendorAccount">
                            {{vendor.Account}}</option>
                    </select>
                </div>

                <div class="forms-rows">
                    <div class="form-group">
                        <label>Template Name <span >*</span></label>
                        <input type="text" name="modelName" ngModel
                            [(ngModel)]="templateName" (change)="removealert()" required pattern="^[a-zA-Z0-9_]{5,20}$">
                    </div>

                    <div class="form-group">
                        <label>Document Format <span>*</span></label>
                        <select name="docFormat" ngModel (change)="changeDocFormat($event.target.value)" required>
                            <option *ngFor="let docf of docFormats" [value]="docf">{{docf}}</option>
                        </select>
                    </div>
                </div>

                <div class="dialog-footer">
                    <button type="submit" class="submit-button"
                        [ngStyle]="{'cursor':(createTemplate.invalid)? 'not-allowed':'pointer'}"
                        [disabled]="createTemplate.invalid">
                        Add Template <i class="fa fa-arrow-right"></i>
                    </button>
                    <div *ngIf="modaladderr" class="alert-msg" role="alert">
                        Model with the same name exists!!
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- The Fields Modal -->
<div *ngIf="isViewTagInfo" class="modal fade" id="FieldsModal">
    <div class="dialog-container">
        <button class="close-button" (click)="closeModal()"><span>×</span></button>
        <div class="dialog-header">
            <h2>View Tagged Information</h2>
        </div>
        <div class="dialog-content">
            <div class="fields-header">
                <h6>All Fields Vs. Tagged</h6>
                <button class="dwnld-buttn" (click)="downloadDoc('vendor')">Download</button>
            </div>
            <span class="vendor-name">{{vendorName}}</span>            
            <div class="vti-nav">
                <span 
                    *ngFor="let tag of tags; let i = index"
                    [class.active]="activeIndex === i"
                    (click)="setActive(i, tag)">
                    {{ tag }}
                </span>
            </div>
            <div class="head-tab">
                <div class="no-ele"  *ngIf="headerTags.length == 0 || LineTags.length == 0">
                    <img src="assets/tag-price-label-svgrepo-com.svg">
                    <span *ngIf="activeIndex === 0">No Header Fields Tagged!</span>
                    <span *ngIf="activeIndex === 1">No Line Item Fields Tagged!</span>
                </div>
                <div class="list-container" *ngIf="activeIndex === 0">
                    <ul class="list-group head-list" *ngFor="let h of headerTags">
                        <li *ngIf="h.Ismendatory != 1" class="list-group-item d-flex align-items-center" style="justify-content: space-between;">
                            {{h.Name}}
                            <span *ngIf="checkHeaderTagged(h.Name)" class="badge bg-success rounded-pill" style="color: #ffffff;padding: 5px;">{{getHeaderStatus(h.Name)}}</span>
                            <span *ngIf="!checkHeaderTagged(h.Name)" class="badge bg-light rounded-pill nt-comp" >Not Tagged</span>
                        </li>
                        <li *ngIf="h.Ismendatory == 1" class="list-group-item d-flex align-items-center list-group-item-danger" style="justify-content: space-between;">
                            {{h.Name}}
                            <span *ngIf="checkHeaderTagged(h.Name)" class="badge bg-danger rounded-pill danger-comp">Mandatory</span>
                        </li>
                    </ul>
                </div>
                <div class="list-container" *ngIf="activeIndex === 1">
                    <ul class="list-group head-list" *ngFor="let l of LineTags">
                        <li *ngIf="l.Ismendatory != 1" class="list-group-item d-flex align-items-center" style="justify-content: space-between;">
                            {{l.Name}}
                            <span *ngIf="checkLineTagged(l.Name)" class="badge bg-success rounded-pill" style="color: #ffffff;padding: 5px;">{{getLineStatus(l.Name)}}</span>
                            <span *ngIf="!checkLineTagged(l.Name)" class="badge bg-light rounded-pill nt-comp">Not Tagged</span></li>
                        <li *ngIf="l.Ismendatory == 1" class="list-group-item d-flex align-items-center list-group-item-danger" style="justify-content: space-between;">
                            {{l.Name}}
                            <span *ngIf="checkLineTagged(l.Name)" class="badge bg-danger rounded-pill danger-comp">Mandatory</span>
                            </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div> 
<!-- The Accuracy Modal -->
<div *ngIf="isConfScr" class="modal fade" id="AccuracyModal">
    <div class="dialog-container">
        <button class="close-button" (click)="closeModal()"><span>×</span></button>
        <div class="dialog-header">
          <h2>View Tagged Information</h2>
        </div>
        <div class="dialog-content">
            <div class="fields-header">
                <h6>Train Vs Test Confidence Scores Vs Actual Accuracy</h6>
                <button class="dwnld-buttn" (click)="downloadDocAccuracy('vendor','2024-10-01','2024-10-30')">Download</button>
            </div>
            <span>{{vendorName}}</span>
            <span>Total Invoices Processed - <b>{{documentCount}}</b></span>
        </div>
        <div class="table-container">
            <table class="confidence-table">
              <thead>
                <tr>
                  <th>Train Confidence Score</th>
                  <th>Test Confidence Score</th>
                  <th>Actual OCR Accuracy</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>{{trainingAverageAccuracy}} </td>
                  <td>{{testingAverageAccuracy}} </td>
                  <td>{{fieldsaccavg}} </td>
                </tr>
                <ng-container *ngFor="let f of trainingFields">
                    <tr *ngIf="!checkincludes(f.fieldName)">
                        <td>{{ f.fieldName }}</td>
                        <td>{{ f.accuracy * 100 }} %</td>
                        <td>{{ getValue(f.fieldName) }}</td>
                        <td>{{ getAccValue(f.fieldName) }}</td>
                    </tr>
                </ng-container>
                
              </tbody>
            </table>
        </div>
    </div>
</div>

  
<!-- <p-dialog header="Add New Template" [(visible)]="displayAddTemplateDialog" [breakpoints]="{'960px': '75vw'}"
  [style]="{width: '31vw'}" [baseZIndex]="10000" [draggable]="false" [resizable]="false">
  <div>
    <label class="inviteLabel">Select Vendor</label>
    <select class="form-control inputBox selectpicker" [(ngModel)]="select_vendorAccount" name="vendrCreate" ngModel #vendrCreate="ngModel"
      (change)="selectVendorAccont(select_vendorAccount)" required>
      <option value="" selected disabled>Select vendor account</option>
      <option *ngFor="let vendor of vendorAccountList" [value]="vendor.VendorName">{{vendor.VendorName}}</option>
    </select>
    <div *ngIf="vendrCreate.errors &&(vendrCreate.touched || vendrCreate.dirty)" class="alertDiv">
      <div [hidden]="!vendrCreate.errors.required">
        **Required field
      </div>
    </div>


    <label class="inviteLabel">Template Name</label>
    <input type="text" class="form-control inputBox" name="fnameCreate" ngModel #fnameCreate="ngModel"
      [(ngModel)]="templateName" required>

    <div *ngIf="fnameCreate.errors &&(fnameCreate.touched || fnameCreate.dirty)" class="alertDiv">
      <div [hidden]="!fnameCreate.errors.required">
        **Required field
      </div>
    </div>

  </div>
  <ng-template pTemplate="footer">
    <button type="button" class="btn btnVender mr-3" (click)="displayAddTemplateDialog = false">Cancel</button>
    <button type="button" class="btn btnVender"
      [ngStyle]="{'cursor':(vendrCreate.invalid  || fnameCreate.invalid )? 'not-allowed':'pointer'}"
      [disabled]="vendrCreate.invalid || fnameCreate.invalid"
      (click)="createTemplate()">Add Template</button>

  </ng-template>
</p-dialog>

<p-toast></p-toast> -->

<p-toast></p-toast>